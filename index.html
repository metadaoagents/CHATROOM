<html>
  
  <head>
    <title>Social </title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/moralis/dist/moralis.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
      
      <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    
        <!-- https://www.icegif.com/wp-content/uploads/black-hole-icegif-7.gif -->
        <!-- https://data.whicdn.com/images/321543919/original.gif -->
      </head>  
      <body style="background-image: url('https://thumbs.gfycat.com/AnyFaithfulHylaeosaurus-max-1mb.gif');">
        
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
          <style>.bg-light {
            background-color: #000000!important;}
            </style>
          
          <img src="https://daoagents.s3.amazonaws.com/meta-dao-agents.jpg" style="width: 125px; height: 78px;"></img>
          <!-- <a class="navbar-brand" href="#">My DEX</a> -->
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                <a class="nav-link" href="#"><span class="sr-only">(current)</span></a>
                </li>
            </ul>

<p id="status"style="color: rgb(94, 92, 92);"></p>


            <div  class="dropdown">
              <button style="background-image: url('https://i.pinimg.com/originals/92/85/29/92852935deb96e204ee60b7ec07f4627.gif');"class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Log in to Chat
              </button>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <button id="btn-login" class="dropdown-item" >Sign in </button>
                <button id="btn-logout" class="dropdown-item" >Sign Out</button>
                
              </div>
            </div>

            
    
    </nav>

    <!-- <button class='centerR' class="w3-button w3-ripple">Button</button>
<button class='centerR'class ="w3-button w3-ripple w3-red">Button</button> -->

<button class='centerR' type="button"><a href="https://meta-dao-agents.s3.amazonaws.com/Airdrops.htm">Alpha Social Airdrop calander</a></button>
<button class='centerR' type="button"><a href="http://100.24.24.59:3000/">Login to Alpha-pack</a></button>

    <!-- <a hre='https://google.com'><button type="button" style='font-family: monospace;color:white; background-image: url("https://thumbs.gfycat.com/FragrantComfortableAsiandamselfly-max-1mb.gif");' class='centerR' ><h4>Alpha-Social airdrop calander</h4></button></a>
    <button type="button" style='font-family: monospace;color:white; background-image: url("https://media2.giphy.com/media/8YTEIhQ85VFwHcNJCI/200.gif");' class='centerR' ><h4>Login to Alpha-pack chatroom</h4></button> -->

    <!-- <button class='centerR'>Login to Alpha-pack chatroom</button> -->

    <br><br>

   
    <style>
      .centerR {
      display: block;
      right: -20px;
      width: 20%;
      height:6%;
      
      float: right;
    }
    </style>
    
<style>
  .center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
}
</style>


	  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://unpkg.com/moralis/dist/moralis.js"></script>
  </head>




  <hr/>
 <br>
 <p style='font-family: monospace;color:white;text-align: center; '> Givng ANONYMOUS Traders , Pumpers and Degens a voice to put their money where their mouth is and generate some alpha together! </p>
 <img class="center" src="group.png" style='text-align: center;width: 150px; height:150px ' alt="">


 <script>
  function refreshPage(){
      window.location.reload();
  } 
  </script>

<script>
  function myFunction() {
    alert("I am an alert box!");
  }
  </script>


 <img class="center" src='https://c.tenor.com/pKMRFrAxu78AAAAd/matrix-neo.gif' style='text-align: center;width: 300px; height:150px ' alt="">

    <!-- <p>Create new group chat: </p> -->
    <input style=" font-family: monospace; color: rgb(255, 255, 255); padding: 10px 20px;background-color: #292828 "    size="70" class="center-block" type="text" placeholder="Enter new Chatroom name" id="group-name-text"/>
    <input onclick="myFunction()" style=" font-family: monospace; text-align: center; color: blanchedalmond ; color: white; padding: 5px 80px; background-image: url('https://i.pinimg.com/originals/92/85/29/92852935deb96e204ee60b7ec07f4627.gif');"  size="100"class="center-block" type="button" value="Create new chatroom" id="btn-new-group-chat"></input>
  
  <div style="text-align: center;">
    <a href="https://35.172.128.241:1101/"><small style="text-align: center; color: white;">Reload page after  creating new chatroom</small></a>
    <!-- <small style="text-align: center; color: red;">Reload page after  creating new chatroom</small> -->

  
  </div>
    <hr/>

    <!-- <input type="button" onClick="window.location.reload()">ji</input> -->
  <body >

<br><br>
    <div class="container" id="window3">
      <div class="center">
    <input  style='font-family: monospace; color: blanchedalmond ; background-color: #404240; position:absolute;right:20px;' size="50" type="text" id="myInput" onkeyup="myFunction()" placeholder="Search for Chatrooms by name or date" title="Type in a name"></div>

    <!-- <button id="btn-login">Moralis Login</button>
    <button id="btn-logout">Logout</button> -->

    

  

    <style>
      .center-block {
  margin: auto;
  display: block;
}
.right-block {
  margin: right;
  display: right;
}

    </style>
    
  

    
    <!-- <p>Join group chat</p> -->

    

    
    <script>
      function myFunction() {
          var input, filter, ul, li, a, i, txtValue;
          input = document.getElementById("myInput");
          filter = input.value.toUpperCase();
          ul = document.getElementById("chatRooms");
          li = ul.getElementsByTagName("tr");
          for (i = 0; i < li.length; i++) {
              a = li[i].getElementsByTagName("a")[0];
              p = li[i].getElementsByTagName("p")[0];
              txtValue = a.textContent || a.innerText;
              txtValue2 = p.textContent || p.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                  li[i].style.display = "";
              }

              else if (txtValue2.toUpperCase().indexOf(filter)  > -1) {
                    li[i].style.display = "";
                
                } 
              
              else {
                  li[i].style.display = "none";
              }
          }
      }
      </script>
      


<!-- 
      <script>
        function myFunction() {
            var input, filter, ul, li, a, p,  i, txtValue;
            input = document.getElementById("myInput");
            filter = input.value.toUpperCase();
            ul = document.getElementById("historyList");
            li = ul.getElementsByTagName("li");
            for (i = 0; i < li.length; i++) {
                a = li[i].getElementsByTagName("a")[0];
                p = li[i].getElementsByTagName("p")[0];
                txtValue = a.textContent || a.innerText;
                txtValue2 = p.textContent || p.innerText;
                if (txtValue.toUpperCase().indexOf(filter)  > -1) {
                    li[i].style.display = "";
                
                } 
  
                else if (txtValue2.toUpperCase().indexOf(filter)  > -1) {
                    li[i].style.display = "";
                
                } 
                
                else {
                    li[i].style.display = "none";
                }
            }
        }
        </script> -->
      </div></div>
      <!-- <div class="col-mb-4" id='marketplaceItemTemplate'> -->
<br><br>
    <div class="col-mb-4" id="chatRooms">
      <!-- <div class="card">
        <div class="container"> -->
      <!-- <thead> -->
      <o class="col-mb-4" id="roomList"></o>
    <!-- </div>
    </div> -->
  <!-- </thead> -->
  </div>

    <hr/>

    <script>
      // connect to Moralis server
      // Moralis.initialize("Sojukv0ZkWHJEo9pqURpjyzVQRoE5oSJ4vmVU8co");
      // Moralis.serverURL = "https://oid22tonbqqn.moralishost.com:2053/server";
      // alert(document.getElementsByTagName('a').length)


      const serverUrl = "https://oid22tonbqqn.moralishost.com:2053/server";
const appId = "Sojukv0ZkWHJEo9pqURpjyzVQRoE5oSJ4vmVU8co";
Moralis.start({ serverUrl, appId });

      // // add from here down
      // async function login() {
      //   let user = Moralis.User.current();
      
      //   if (!user) {
      //     user = await Moralis.Web3.authenticate()
          
      //   }

        
        async function login() {
    let user = Moralis.User.current();
    await Moralis.Web3.authenticate()
    if (!user) {
      user = await Moralis.Web3.authenticate()
      .then(function (user) {
          console.log("logged in user:", user.get("ethAddress"));
          // document.getElementById("num").innerHTML = user.get("ethAddress")
      })
    }



        
        
        document.getElementById('chatRooms').innerHTML += "<div class='container'><div class='center' id='chatRooms'> </div></div>"
        alert("Successfully logged in ", user);
        window.location.reload()
       
      }
      
      async function logOut() {
        await Moralis.User.logOut();
        console.log("logged out");
        window.location.reload()
        alert("successfully logged out ");
      }

      async function newGroupChat(){

        let user = Moralis.User.current();
        if (!user) {
          alert('Please log in to create a chatroom')
          
        }
        
        let chatTitle1 = document.getElementById("group-name-text").value;
        if(chatTitle1.length<3){
          alert('Chat name too short')}
        if(chatTitle1.length>45){
          alert('Chat name shuld be less than 30 charachters long')}
        else if (chatTitle1.length>2) {
        var chatTitle = chatTitle1.replace(/<[^>]+>/g, '');
        const Chats = Moralis.Object.extend("Chats");
        const chat = new Chats();
        let user = Moralis.User.current();
        console.log(user.get("ethAddress"))
        chat.set("title", chatTitle);
        // chat.set("address", user.get("ethAddress"));
        chat.set("Adresss",user.get("ethAddress"))
        chat.save()}
        
        // alert("created group chat with title " + chatTitle);
        await new Promise(resolve => setTimeout(resolve, 950)); 
        
        window.location.href = "http://100.24.24.59:1100/index.html";
        
        
      }

  

      async function getGroupChats(){
        const Chats = Moralis.Object.extend("Chats");
        const query = new Moralis.Query(Chats);
        query.descending("createdAt");
        query.limit(10000)
        const results = await query.find();

        const roomList = document.getElementById("roomList");
        let user = Moralis.User.current();
        



        for (let i = 0; i < results.length; i++) {
          const object = results[i];
          // console.log(object.get('title'));
        

          
        //   let query2 = new Moralis.Query('Chats');
        //   query.equalTo('group',object.id)
        // const results2 = await query.find();
        
        // console.log(results2.length)


          var listItem = document.createElement('tr');
          let str_date= object.get('createdAt')
          var str_date2=  str_date.toString().slice(0,25)
          listItem.innerHTML = "  <div class='card h-100 border-light bg-transparent text-light' style='margin-bottom: 10px;margin-right: 5px;margin-left: 5px; background-color:#262525'> <h4> &#160&#160&#160&#160&#160&#160<a  href='chat.html?id="+object.id+"'>"+object.get('title')+"</a></h4>" + " <p style='font-family: monospace; text-align: center; color: blanchedalmond;'>&#160&#160 "+ `<a href='https://etherscan.io/address/${object.get("Adresss")}'><img width="50" height="50" src="https://avatars.dicebear.com/api/pixel-art/${object.get("Adresss")}.svg"></img></a>`+'created '  +str_date2  +' <br> &#160&#160&#160&#160&#160&#160 </p> </div><div>'
          roomList.appendChild(listItem);
        }

        
      

      }

     
      getGroupChats();

      document.getElementById("btn-login").onclick = login;
      document.getElementById("btn-logout").onclick = logOut;
      document.getElementById("btn-new-group-chat").onclick = newGroupChat;
      

    </script>

    




<!-- <style>
  <style>
    .card {
    position: relative;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-direction: column;
    flex-direction: column;
    min-width: 0;
    word-wrap: break-word;
    background-color: #000000;
    background-clip: border-box;
    border: 1px solid rgba(0,0,0,.125);
    border-radius: .25rem;
}
/* .card {
  color: black;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
  width: 40%;
} */

.card:hover {
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
}

.container {
  padding: 2px 16px;
  color: #404240;
}
</style> -->
</style>


  </body>




</html>
